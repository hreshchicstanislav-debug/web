# Описание пользовательского интерфейса вкладки "Задачи"

## Общее описание

Вкладка "Задачи" — это экран для контроля работы фотографа по съёмке товаров. Здесь отображается статистика за текущую неделю: сколько товаров уже отснято, сколько осталось сделать, и насколько близко к плану.

Данные берутся из системы Asana, где фотограф ведёт задачи по каждому товару. Система автоматически считает статистику и показывает её в удобном виде.

---

## Что видит пользователь при открытии вкладки

### 1. Заголовок
**"Задачи Asana"** — название вкладки вверху страницы.

---

### 2. Основные карточки с показателями (5 карточек в сетке)

#### Карточка 1: "Сделано" (зелёная)
**Что показывает:** Общее количество товаров, которые уже полностью готовы (отсняты и обработаны) за эту неделю.

**Что внутри:**
- Большое число — это сумма: фактически сделанное на этой неделе + переработка с прошлой недели
- Подпись "Факт" с числом — сколько товаров реально сделано именно на этой неделе
- Подпись "Переработка с прошлой недели" с числом — сколько товаров было сделано сверх плана на прошлой неделе и зачтено в эту неделю

**Зачем нужно:** Понять общий объём выполненной работы, включая переработку.

---

#### Карточка 2: "Предстоит отснять" (оранжевая)
**Что показывает:** Сколько товаров ещё нужно отснять в эту неделю по плану (по срокам выполнения задач).

**Что внутри:**
- Большое число — количество товаров
- Подпись "товаров"

**Зачем нужно:** Понять, сколько работы ещё осталось сделать до конца недели.

---

#### Карточка 3: "Запланировано" (синяя)
**Что показывает:** Динамический план на неделю — сколько товаров нужно сделать (от 80 до 100, зависит от нагрузки).

**Что внутри:**
- Большое число — план на неделю (80-100)
- Подпись "динамический план недели"
- Подпись "Нагрузка недели" с числом — это сумма: что уже сделано + что ещё предстоит

**Зачем нужно:** Понять, какой план установлен на эту неделю и какая общая нагрузка.

---

#### Карточка 4: "До выполнения плана" (розовая или зелёная)
**Что показывает:** Сколько товаров осталось сделать до выполнения плана.

**Что внутри:**
- Большое число — остаток до плана
- Подпись "товаров (план: X)" — показывает, какой план установлен

**Особенность:** 
- Если число положительное (например, 20) — карточка розовая, значит ещё нужно сделать 20 товаров
- Если число 0 или отрицательное — карточка зелёная, значит план выполнен или перевыполнен

**Зачем нужно:** Быстро понять, выполнен ли план или сколько ещё осталось.

---

#### Карточка 5: "Переработка этой недели" (серая, если 0, или выделенная, если > 0)
**Что показывает:** Сколько товаров сделано сверх плана на этой неделе.

**Что внутри:**
- Большое число — количество товаров сверх плана
- Подпись "товаров сверх плана"

**Зачем нужно:** Понять, есть ли переработка, которая может быть зачтена на следующей неделе.

---

### 3. Дополнительные показатели (список под карточками)

Это простой список из 4 строк, каждая показывает название и число:

1. **"Сфоткано, но не обработано"** — сколько товаров уже сфотографировано, но ещё не обработано (фото не готовы)
2. **"Уже на руках"** — сколько товаров физически находится у фотографа, но ещё не сфотографировано
3. **"Нужно взять со склада"** — сколько товаров нужно взять самому со склада (ещё не начата работа)
4. **"Ошибки Q"** — сколько задач, где не указано количество товаров (Q), но задача должна участвовать в планах. Если есть ошибки, показывается значок ⚠️

**Зачем нужно:** Быстро увидеть статус работы — что на руках, что в процессе обработки, что нужно взять.

---

### 4. Кнопка "Обновить данные"

**Что делает:** Запрашивает свежие данные из Asana и пересчитывает всю статистику.

**Под кнопкой:** Текст-подсказка "Нажмите кнопку для получения актуальной статистики из Asana."

**Зачем нужно:** Если данные устарели или нужно обновить статистику после изменений в Asana.

---

### 5. Кнопка "Показать подробности"

**Что делает:** Раскрывает/скрывает детальную таблицу со всеми задачами недели.

**При первом нажатии:** Показывает таблицу с задачами.
**При повторном нажатии:** Скрывает таблицу.

---

### 6. Детальная таблица (появляется после нажатия "Показать подробности")

**Что показывает:** Список всех задач текущей недели с подробной информацией.

**Колонки в таблице:**

1. **"Задача"** — название задачи из Asana (например, "Средний_Шоколадки_8_НЕ СТМ")
   - Под названием мелким серым текстом показываются технические ID (project_gid, assignee_gid) — это служебная информация

2. **"Q"** — количество товаров в задаче
   - Если Q отсутствует или равно 0, ячейка подсвечивается красным и показывается значок ⚠️

3. **"Товар"** — источник товара:
   - "Принесли" (PRINESLI) — товар уже принесли фотографу
   - "Со склада" (WAREHOUSE) — нужно взять самому со склада

4. **"Статус"** — завершена ли задача:
   - "Сделано" (зелёный) — задача завершена
   - "Не сделано" (серый) — задача не завершена

5. **"Сфоткал"** — дата, когда товар был сфотографирован (из поля "когда сфоткал" в Asana)
   - Формат: ДД.ММ.ГГГГ (например, 21.11.2025)
   - Если дата не указана, показывается "—"

6. **"Обработал"** — дата, когда товар был обработан (из поля "когда обработал" в Asana)
   - Формат: ДД.ММ.ГГГГ
   - Если дата не указана, но задача завершена, используется дата завершения задачи
   - Если дата не указана и задача не завершена, показывается "—"

7. **"Дедлайн"** — срок выполнения задачи (плановая дата)
   - Формат: ДД.ММ.ГГГГ
   - Если дата не указана, показывается "—"

**Фильтры в таблице:**

- **Чекбокс "Показать только задачи с ошибкой Q"** — если включен, показывает только задачи, где Q отсутствует или равно 0
- **Селект "Проект"** — фильтр по проекту Asana (если задач из разных проектов)

**Особенности:**

- Задачи с ошибкой Q подсвечиваются светло-красным фоном
- Таблица сортируется: сначала по дате обработки (новые сверху), потом по дате съёмки, потом по дедлайну
- На мобильных устройствах таблица превращается в карточки (каждая задача — отдельная карточка)

**Зачем нужно:** Увидеть детали по каждой задаче, найти проблемы (отсутствие Q, пропущенные даты), понять, какие задачи в работе, а какие уже готовы.

---

## Как работает обновление данных

1. **При открытии вкладки:** Показываются закешированные данные (если есть) для быстрой загрузки
2. **При нажатии "Обновить данные":**
   - Кнопка становится неактивной, показывается "Обновление..."
   - Система запрашивает свежие данные из Asana через серверную функцию
   - Данные пересчитываются и обновляются все карточки и таблица
   - Показывается уведомление "Данные успешно обновлены!"
3. **Автоматическое обновление:** Система может обновлять данные автоматически через webhooks от Asana (если настроено)

---

## Визуальное оформление

- **Цвета карточек:**
  - Зелёная — "Сделано" (положительный результат)
  - Оранжевая — "Предстоит отснять" (требует внимания)
  - Синяя — "Запланировано" (информация)
  - Розовая/Зелёная — "До выполнения плана" (розовая = нужно доделать, зелёная = план выполнен)
  - Серая/Выделенная — "Переработка" (серая если 0, выделенная если есть переработка)

- **Размеры:**
  - На десктопе: карточки располагаются в сетке (обычно 2-3 колонки)
  - На мобильных: карточки располагаются в 2 колонки или в 1 колонку (зависит от ширины экрана)
  - Шрифты адаптируются под размер экрана

---

## Типичные сценарии использования

### Сценарий 1: Утренняя проверка
1. Открываю вкладку "Задачи"
2. Смотрю карточку "Сделано" — сколько уже готово
3. Смотрю карточку "До выполнения плана" — сколько ещё осталось
4. Смотрю "Уже на руках" — какие товары ждут съёмки
5. Смотрю "Сфоткано, но не обработано" — что нужно обработать

### Сценарий 2: Поиск проблем
1. Открываю "Показать подробности"
2. Включаю фильтр "Показать только задачи с ошибкой Q"
3. Нахожу задачи без количества товаров
4. Иду в Asana и исправляю

### Сценарий 3: Обновление после работы
1. Сфотографировал товары, проставил даты в Asana
2. Нажимаю "Обновить данные"
3. Проверяю, что "Сделано" увеличилось, "Уже на руках" уменьшилось
4. Проверяю, что "Сфоткано, но не обработано" обновилось

---

## Проблемы и неудобства текущего интерфейса

1. **Много информации в одной карточке "Сделано"** — показывается и факт, и переработка, что может быть запутанно
2. **Дополнительные показатели в простом списке** — не очень заметны, легко пропустить
3. **Детальная таблица скрыта** — нужно нажимать кнопку, чтобы увидеть детали
4. **Технические ID в таблице** — project_gid и assignee_gid показываются мелким текстом, засоряют интерфейс
5. **На мобильных мелкие шрифты** — некоторые подписи трудно читать
6. **Нет группировки задач** — все задачи в одной таблице, сложно найти нужные
7. **Нет индикации актуальности данных** — непонятно, когда данные последний раз обновлялись
8. **Карточка "Переработка" может быть не видна** — если переработки нет, карточка серая и не заметна

---

## Что важно для пользователя

- **Быстро понять:** сколько сделано, сколько осталось, выполнен ли план
- **Увидеть проблемы:** задачи без Q, пропущенные даты
- **Понять статус:** что на руках, что в обработке, что нужно взять
- **Обновить данные:** получить актуальную статистику после работы в Asana

