# Инструкция по развертыванию TimeTrack

## 1. Обнуление базы данных

### Способ 1: Через SQL Editor в Supabase

1. Откройте Supabase Dashboard: https://supabase.com/dashboard
2. Выберите ваш проект
3. Перейдите в **SQL Editor** (SQL редактор)
4. Откройте файл `CLEAR_DATABASE.sql` из проекта
5. Скопируйте содержимое и выполните в SQL Editor
6. Подтвердите удаление всех данных

### Способ 2: Через Supabase Dashboard

1. Откройте Supabase Dashboard
2. Перейдите в **Table Editor**
3. Выберите таблицу `time_tracks`
4. Выберите все записи (Ctrl+A / Cmd+A)
5. Нажмите **Delete** (Удалить)
6. Подтвердите удаление

### Очистка Storage (фотографии)

1. В Supabase Dashboard перейдите в **Storage**
2. Выберите bucket **`photos`**
3. Выберите все файлы
4. Нажмите **Delete** (Удалить)
5. Подтвердите удаление

---

## 2. Настройка PWA (Progressive Web App)

PWA уже настроено! Файлы созданы:
- ✅ `manifest.webmanifest` - манифест приложения
- ✅ `service-worker.js` - сервис-воркер для офлайн работы
- ✅ Иконки: `icon-192.png` и `icon-512.png`

### Что уже работает:

1. **Service Worker** автоматически регистрируется при загрузке страницы
2. **Manifest** подключен в `index.html`
3. **Иконки** настроены для установки на главный экран

### Установка на смартфон:

#### Android (Chrome):
1. Откройте сайт в Chrome
2. Нажмите меню (три точки) → **"Добавить на главный экран"** или **"Установить приложение"**
3. Подтвердите установку
4. Иконка появится на главном экране

#### iOS (Safari):
1. Откройте сайт в Safari
2. Нажмите кнопку **"Поделиться"** (квадрат со стрелкой)
3. Прокрутите вниз и выберите **"На экран «Домой»"**
4. Подтвердите установку
5. Иконка появится на главном экране

---

## 3. Развертывание на GitHub Pages

### Шаг 1: Создание репозитория на GitHub

1. Откройте https://github.com
2. Нажмите **"New repository"** (Новый репозиторий)
3. Введите имя репозитория (например, `timetrack`)
4. Выберите **Public** (публичный)
5. **НЕ** ставьте галочки на "Add README", "Add .gitignore", "Choose a license"
6. Нажмите **"Create repository"**

### Шаг 2: Инициализация Git и загрузка файлов

Откройте терминал в папке проекта и выполните:

```bash
# Перейдите в папку проекта
cd /Users/stanislav/web:

# Инициализация Git (если еще не инициализирован)
git init

# Добавление всех файлов
git add .

# Первый коммит
git commit -m "Initial commit: TimeTrack PWA app"

# Добавление удаленного репозитория (замените YOUR_USERNAME на ваш GitHub username)
git remote add origin https://github.com/YOUR_USERNAME/timetrack.git

# Загрузка на GitHub
git branch -M main
git push -u origin main
```

### Шаг 3: Настройка GitHub Pages

1. Откройте ваш репозиторий на GitHub
2. Перейдите в **Settings** (Настройки)
3. В левом меню найдите **Pages** (Страницы)
4. В разделе **Source** (Источник):
   - Выберите **Branch: main**
   - Выберите папку **/ (root)**
   - Нажмите **Save** (Сохранить)
5. Подождите 1-2 минуты
6. Ваш сайт будет доступен по адресу: `https://YOUR_USERNAME.github.io/timetrack/`

### Шаг 4: Обновление путей (ВАЖНО!)

Если ваш репозиторий называется **НЕ** `timetrack`, нужно обновить пути:

#### Обновление manifest.webmanifest:

Замените `/` на `/ИМЯ_ВАШЕГО_РЕПОЗИТОРИЯ/`:

```json
{
  "start_url": "/ИМЯ_ВАШЕГО_РЕПОЗИТОРИЯ/#/me",
  "scope": "/ИМЯ_ВАШЕГО_РЕПОЗИТОРИЯ/",
  "icons": [
    {
      "src": "/ИМЯ_ВАШЕГО_РЕПОЗИТОРИЯ/icon-192.png",
      ...
    },
    {
      "src": "/ИМЯ_ВАШЕГО_РЕПОЗИТОРИЯ/icon-512.png",
      ...
    }
  ]
}
```

#### Обновление index.html:

Замените пути к иконкам и manifest:

```html
<link rel="icon" type="image/png" href="/ИМЯ_ВАШЕГО_РЕПОЗИТОРИЯ/icon-192.png">
<link rel="manifest" href="/ИМЯ_ВАШЕГО_РЕПОЗИТОРИЯ/manifest.webmanifest">
```

**Примечание**: Service Worker и app.js автоматически определяют правильные пути, обновлять их не нужно.

### Шаг 5: Проверка работы

1. Откройте ваш сайт: `https://YOUR_USERNAME.github.io/timetrack/`
2. Проверьте консоль браузера (F12) - не должно быть ошибок
3. Проверьте, что:
   - Страница загружается
   - Навигация работает
   - Данные сохраняются в Supabase
   - Фото загружаются
   - Service Worker зарегистрирован (проверьте в консоли)

### Шаг 6: Обновление кода

После каждого изменения:

```bash
git add .
git commit -m "Описание изменений"
git push
```

Изменения появятся на сайте через 1-2 минуты.

---

## Файлы для загрузки на GitHub

Убедитесь, что следующие файлы есть в репозитории:
- ✅ `index.html`
- ✅ `app.js`
- ✅ `manifest.webmanifest`
- ✅ `service-worker.js`
- ✅ `icon-192.png`
- ✅ `icon-512.png`

## Файлы, которые НЕ нужно загружать

Файл `.gitignore` уже создан и исключает:
- `пароль.txt`
- Временные файлы
- Служебные файлы

---

## Решение проблем

### Service Worker не работает:
- Убедитесь, что сайт открыт по HTTPS (GitHub Pages автоматически предоставляет HTTPS)
- Проверьте консоль браузера на ошибки
- Убедитесь, что `service-worker.js` доступен

### PWA не устанавливается:
- Проверьте, что `manifest.webmanifest` корректен
- Убедитесь, что иконки доступны
- Проверьте консоль браузера на ошибки
- Убедитесь, что сайт открыт по HTTPS

### Пути не работают:
- Убедитесь, что все пути начинаются с `/` или `/ИМЯ_РЕПОЗИТОРИЯ/`
- Проверьте, что файлы загружены в корень репозитория
- Проверьте консоль браузера на ошибки 404

### Изменения не появляются:
- Очистите кэш браузера (Ctrl+Shift+Delete / Cmd+Shift+Delete)
- Используйте режим инкогнито
- Подождите 1-2 минуты после push

